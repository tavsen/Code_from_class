#include <iostream>
///если будет долго работать надо будет записать все цифры всех чисел в один массив
using namespace std;

/**
1) находим все простые числа с одинаковым кол-вом цифр
2) перебираются простые числа, разделяются на цифры
3) не сравниваем числа с 1 и 2 * т.к. каждое третье число из 10 возможных делится нв 3
4) сравниваем числа с несколькими *
а) проверяем есть ли в числе 3 одинаковых цифры, если да то записываем индексы одинаковых (*) и неодинаковых цифр в массивы
б) перебираются еще раз простые числа, разделяются на цифры и цифры сравниваются с неодинаковыми цифрами первых простых чисел (относительно индексов из массива)
в) проверяем одинаковые (*) ли цифры (относительно индексов, записанных в массив), если да то это число входит в семейство
*/



int main()
{
    setlocale (LC_ALL, "rus");
    int a, b=1000000, numb, n, z=0, k, r, m, t, h, j, g, x, i=1, q, c, s;
    int simple [100000];
    int num [100];    //цифры простых чисел
    int num2 [100];
    int same [100];
    int other [100];
    for (a=10001; a<b; a+=2) { ///записываем простые числа в массив (с одинаковым кол-вом цифр)
            //cout << a << "  ";
            if (a>b/10) {           ///если число увеличилось на 1 цифру, тогда все простые числа с одинаковым кол-вом цифр записались в массив и можно приступать к поиску семейства из 8 чисел
                r=z;
                s=1;
                //cout << r << endl << endl;
                j=x;
                for (s; s<=z; s++) { ///перебираем простые числа
                    k=0;
                    numb = simple [s];

                    //cout << endl << numb << " - ";
                    for (numb; numb>0; numb) {  ///разделяем число на цифры
                        k++;
                        num[k] = numb%10;
                        numb /= 10;
                        //cout << ", " << num [k] ;
                    }

                    for (t=0; t<10; t++) {    ///проверяем есть ли одинаковые цифры
                        g=0;
                        h=0;
                        for (m=k; m>0; m--) {
                            if (num [m] == t) {  //ищем одинаковые цифры в числе
                                g++;
                                same [g] = m;  //записываем индексы одинаковых цифр
                            }
                            else {
                                h++;
                                other [h] = m;      //записываем индексы других цифр (для сравнения)
                            }
                        }
                        i=0;
                        if (g>2) {   //если есть 3 одинаковых цифры
                        //cout << endl << simple [s] << " other: ";
                            for (q=h; q>0; q--) {
                                ///cout << num [other [q]] << "(" << q << ")" << " ";
                            }

                            for (j=r; j>0; j--) {   ///перебираем простые числа для сравнения
                                numb = simple [j];
                                ///cout << endl <<" сравниваем с - " << numb;
                                x=0;
                                for (numb; numb>0; numb) {  ///разделяем число на цифры для сравнения
                                    x++;
                                    num2[x] = numb%10;
                                    numb /= 10;
                                    ///cout << ' ' << num2[x] << "(" << x << ")" << " ";
                                    }
                                for (q=h; q>0; q--) {     ///сравниваем цифры
                                    //cout << q;
                                    //cout << " " << num2 [other [q]] << "(" << other [q] << ")" << "  ";
                                    if (num [other [q]] == num2 [other [q]]) {
                                        if (q==1) {
                                            for (c=g; c>1; c) {
                                                if (num2 [same[c]] == num2 [same[c-=1]]) {
                                                    if (c==1) {
                                                        i++;
                                                        //cout << i << " ";
                                                        //cout << " входит в семейство - " << simple [j] << "  ";
                                                        if (i==8) {
                                                        cout << simple  [j] << endl;
                                                        //system("pause");
                                                        return 0;
                                                        }                                                    }
                                                }
                                                else break;
                                            }
                                        }
                                    }
                                    else break;
                                }
                            }
                        }
                    }
                if (z==s) {
                    z=0;
                    b*=10;
                }
                }
            }

        for (n=3; n>0; n+=2) {  ///проверка на простоту
                if (a%n==0) break;
                if (n*n>=a) {
                    z++;
                    simple [z] = a;
                    //cout << " - " << z << "   ";
                    break;
                    ///если будет долго работать надо будет записать все цифры всех простых чисел в один массив
                }
            }

    }

    return 0;
}